{% extends 'Template.html.twig' %}
{% block body %}
    <ol class="breadcrumb">
        <li><a href="{{ path('admin_homepage') }}"><i class="fa fa-dashboard"></i> Tableau de bord</a></li>
        <li class="active">
            <a href="{{ path('_list_demande') }}">
                Demandes
            </a>
        </li>
        <li class="active">
            Liste Demande
        </li>
    </ol>
    <div class="box">
        <div class="box-header">
            <h3 class="box-title">Liste des demandes</h3>
            <div class="box-tools">
                <a href="{{ path('_create_demande') }}" type="button" class="btn btn-block btn-primary btn-lg">Créer une demande</a>
            </div><br>
        </div><br>

        <!-- /.box-header -->
        <div class="box-body no-padding" id="a5">
            <table class="table table-condensed">
                <tbody><tr>
                    <th>Titre</th>
                    <th>Emetteur</th>
                    <th>Destinataire</th>
                    <th>Addresse</th>
                    <th>Tel</th>
                    <th>Etat</th>
                    <th>Livreur</th>
                    <th>#Aff</th>
                    <th>#Mod</th>
                    <th>#Supp</th>
                    <th>#Conf</th>
                    <th>#Telecharger</th>

                </tr>

                {% if listDemandes is empty %}
                    <tr><th> Aucun demande enregistré</th></tr>
                {% else %}
                    {% for d in listDemandes %}
                        <tr class="{% if d.readDemande == false %} notRead {% endif %}">
                            <td>{{ d.titre }}</td>
                            <td>{{ d.idClient.nom }} {{ d.idClient.prenom }}</td>
                            <td>{{ d.nomPrenomRecept }}</td>
                            <td>{{ d.addresseRecept }} </td>
                            <td>{{ d.telephoneRecept }}</td>

                            <td>






                                {% if (d.etat == false) and (d.idLivreur == null)  %}
                                    <span class="label label-info">En Traitement</span>
                                    {% elseif (d.etat ==null) and (d.idLivreur != null) %}
                                        <span class="label label-warning">Encours</span>
                                    {% else %}
                                    <span class="label label-success">Validé</span>

                                {% endif %}









                            </td>

                            <td>

                                {% if d.idLivreur != null %}
                                  {{ d.idLivreur.nom }} {{ d.idLivreur.prenom }}
                                {% else %}
                                    -
                                {% endif %}


                            </td>

                            <td>
                                {% if d.etat == false %}
                                <a href="{{ path('_assign_demande',{'id_demande':d.id}) }}">Affecter</a>
                                    {% else %}
                                    -
                                {% endif %}
                            </td>
                            <td><a href="{{ path('_update_demande',{'id':d.id}) }}">Modifier</a></td>
                            <td><a href="{{ path('_remove_demande',{'id':d.id}) }}">Supprimer</a></td>
                            <td>


                                {% if d.idLivreur != null and d.etat == true %}
                                    -
                            {% else %}
                                <a href="{{ path('_valide_demande', {'id_demande': d.id}) }}"> Confirmer</a>

                                {% endif %}



                            </td>

                            <td>
                                <a href="{{ path('_generate_url', {'id_demande': d.id}) }}"> Telecharger</a>

                            </td>
                        </tr>
                    {% endfor %}
                {% endif %}


                </tbody>

            </table>
        </div>
        <!-- /.box-body -->
    </div>

{% endblock %}